{% extends "base.html" %}
{% import "macro_heading.html" as headings %}

{% block content %}

    {% include "pages_index.html" %}

    {% for page in pages %}
        <article id="{{ page.named }}">
            {% call headings.article() %}
                {{ page.title }}
            {% endcall %}
            <p>
                {{ page.html|safe }}
            </p>
        </article>
    {% endfor %}


    {% set comment_page = pages|first %}
    {% if comment_override_id %}
        {% set page_id = comment_override_id %} 
        {% set page_title = comment_override_title %}
    {% else %}
        {% if comment_page.comments %}
            {% set page_id = url_for( "page", page_path=comment_page.path ) %}
            {% set page_title = comment_page.title %}
        {% endif %}
    {% endif %}
    {% if page_id %}
        <article id="comments">
            {% call headings.article() %}
                Comments for {{ page_title|title }}
            {% endcall %}
            {% include "disqus_comment_thread.html" %}
        </article>
    {% endif %}

{% endblock %}
